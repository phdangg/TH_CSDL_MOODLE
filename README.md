![](img/Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.001.png)









**GIAOVIEN** (MAGV, HOTEN, LUONG, PHAI, NGAYSINH, DIACHI, GVQLCM, MABM) 

**GV\_DT** (MAGV, DIENTHOAI) 

**BOMON** (MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC) 

**KHOA** (MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC) 

**DETAI** (MADT, TENDT, KINHPHI, CAPQL, NGAYBD, NGAYKT, MACD, GVCNDT) 

**CHUDE** (MACD, TENCD) 

**CONGVIEC** (MADT, STT, TENCV, NGAYBD, NGAYKT) THAMGIADT(MAGV, MADT, STT, PHUCAP, KETQUA)

**YÊU CẦU CỦA BÀI TẬP**

**4.1 TẠO LẬP CƠ SỞ DỮ LIỆU @ TUẦN 2**

C1. Viết script tạo table, khóa chính, khóa ngoại và các ràng buộc cơ bản cho CSDL ở trến.

C2. Viết script để nhập dữ liệu minh họa như mô tả ở trến vào CSDL vừa tạo.

**4.2 VIÊT CÁC CẦU TRUY VẦN ĐƠN GIẢN @ TUẦN 3**

Q1. Cho biết họ tến và mức lương của các giáo viến nữ.

Q2. Cho biết họ tến của các giáo viến và lương của họ sau khi tăng 10%.

Q3. Cho biết mã của các giáo viến có họ tến băt đầu là “Nguyễn” và lương trến $2000 hoặc, giáo viến là trưởng bộ môn nhận chức sau năm 1995.

Q4. Cho biết tến những giáo viến khoa Công nghệ thông tin.

Q5. Cho biết thông tin của bộ môn cùng thông tin giảng viến làm trưởng bộ môn đó.

Q6. Với môi giáo viến, hãy cho biết thông tin của bộ môn mà họ đang làm việc.

Q7. Cho biết tến đế tài và giáo viến chủ nhiệm đế tài.

Q8. Với môi khoa cho biết thông tin trưởng khoa.

Q9. Cho biết các giáo viến của bộ môn “Vi sinh” có tham gia đế tài 006.

Q10. Với những đế tài thuộc cầp quản lý “Thành phô”, cho biết mã đế tài, đế tài thuộc vế chủ đế nào, họ tến người chủ nghiệm đế tài cùng với ngày sinh và địa chỉ của người ầy.

Q11. Tìm họ tến của từng giáo viến và người phụ trách chuyến môn trực tiếp của giáo viến đó.

Q12. Tìm họ tến của những giáo viến được “Nguyến Thanh Tùng” phụ trách trực tiếp.

Q13. Cho biết tến giáo viến là trưởng bộ môn “Hệ thông thông tin”.

Q14. Cho biết tến người chủ nhiệm đế tài của những đế tài thuộc chủ đế Quản lý giáo dục.

Q15. Cho biết tến các công việc của đế tài HTTT quản lý các trường ĐH có thời gian băt đầu trong

tháng 3/2008.

Q16. Cho biết tến giáo viến và tến người quản lý chuyến môn của giáo viến đó. Q17. Cho các công việc băt đầu trong khoảng từ 01/01/2007 đến 01/08/2007.

Q18. Cho biết họ tến các giáo viến cùng bộ môn với giáo viến “Trần Trà Hương”.

Q19. Tìm những giáo viến vừa là trưởng bộ môn vừa chủ nhiệm đế tài.

Q20. Cho biết tến những giáo viến vừa là trưởng khoa và vừa là trưởng bộ môn.

Q21. Cho biết tến những trưởng bộ môn mà vừa chủ nhiệm đế tài.

Q22. Cho biết mã sô các trưởng khoa có chủ nhiệm đế tài.

Q23. Cho biết mã sô các giáo viến thuộc bộ môn “HTTT” hoặc có tham gia đế tài mã “001”.

Q24. Cho biết giáo viến làm việc cùng bộ môn với giáo viến 002.

Q25. Tìm những giáo viến là trưởng bộ môn.

Q26. Cho biết họ tến và mức lương của các giáo viến.

**4.3 VIÊT CÁC CẦU TRUY VẦN SỬ DỤNG HÀM KÊT HỢP & GOM NHÓM** 

**@ TUẦN 4**

Q27. Cho biết sô lượng giáo viến viến và tổng lương của họ.

Q28. Cho biết sô lượng giáo viến và lương trung bình của từng bộ môn.

Q29. Cho biết tến chủ đế và sô lượng đế tài thuộc vế chủ đế đó.

Q30. Cho biết tến giáo viến và sô lượng đế tài mà giáo viến đó tham gia.

Q31. Cho biết tến giáo viến và sô lượng đế tài mà giáo viến đó làm chủ nhiệm.

Q32. Với môi giáo viến cho tến giáo viến và sô người thần của giáo viến đó.

Q33. Cho biết tến những giáo viến đã tham gia từ 3 đế tài trở lến.

Q34. Cho biết sô lượng giáo viến đã tham gia vào đế tài Ứng dụng hóa học xanh.

**4.4 VIÊT CÁC CẦU TRUY VẦN LỒNG** 

**@ TUẦN 5**

Q35. Cho biết mức lương cao nhầt của các giảng viến.

Q36. Cho biết những giáo viến có lương lớn nhầt.

Q37. Cho biết lương cao nhầt trong bộ môn “HTTT”.

Q38. Cho biết tến giáo viến lớn tuổi nhầt của bộ môn Hệ thông thông tin.

Q39. Cho biết tến giáo viến nhỏ tuổi nhầt khoa Công nghệ thông tin.

Q40. Cho biết tến giáo viến và tến khoa của giáo viến có lương cao nhầt.

Q41. Cho biết những giáo viến có lương lớn nhầt trong bộ môn của họ.

Q42. Cho biết tến những đế tài mà giáo viến Nguyến Hoài An chưa tham gia.

Q43. Cho biết những đế tài mà giáo viến Nguyến Hoài An chưa tham gia. Xuầt ra tến đế tài, tến f người chủ nhiệm đế tài.

Q44. Cho biết tến những giáo viến khoa Công nghệ thông tin mà chưa tham gia đế tài nào.

Q45. Tìm những giáo viến không tham gia bầt kỳ đế tài nào

Q46. Cho biết giáo viến có lương lớn hơn lương của giáo viến “Nguyến Hoài An”

Q47. Tìm những trưởng bộ môn tham gia tôi thiểu 1 đế tài

Q48. Tìm giáo viến trùng tến và cùng giới tính với giáo viến khác trong cùng bộ môn

Q49. Tìm những giáo viến có lương lớn hơn lương của ít nhầt một giáo viến bộ môn “Công nghệ phần mếm”

Q50. Tìm những giáo viến có lương lớn hơn lương của tầt cả giáo viến thuộc bộ môn “Hệ thông thông tin”

Q51. Cho biết tến khoa có đông giáo viến nhầt

Q52. Cho biết họ tến giáo viến chủ nhiệm nhiếu đế tài nhầt

Q53. Cho biết mã bộ môn có nhiếu giáo viến nhầt

Q54. Cho biết tến giáo viến và tến bộ môn của giáo viến tham gia nhiếu đế tài nhầt.

Q55. Cho biết tến giáo viến tham gia nhiếu đế tài nhầt của bộ môn HTTT.

Q56. Cho biết tến giáo viến và tến bộ môn của giáo viến có nhiếu người thần nhầt.

Q57. Cho biết tến trưởng bộ môn mà chủ nhiệm nhiếu đế tài nhầt.

**4.5 VIÊT CÁC CẦU TRUY VẦN LỒNG NẦNG CAO** 

**@ TUẦN 6**

*Yêu cầu: Mỗi cầu truy vần SV viêt theo 3 cách lần lượt sử dụng **EXCEPT**, **NOT EXISTS** và **COUNT**.*

*Q58.* Cho biết tên giáo viến nào mà tham gia đế tài đủ tầt cả các chủ đế.

Q59. Cho biết tến đế tài nào mà được tầt cả các giáo viến của bộ môn HTTT tham gia.

Q60. Cho biết tến đế tài có tầt cả giảng viến bộ môn “Hệ thông thông tin” tham gia

Q61. Cho biết giáo viến nào đã tham gia tầt cả các đế tài có mã chủ đế là QLGD.

Q62. Cho biết tến giáo viến nào tham gia tầt cả các đế tài mà giáo viến Trần Trà Hương đã tham gia. 

Q63. Cho biết tến đế tài nào mà được tầt cả các giáo viến của bộ môn Hóa Hữu Cơ tham gia.

Q64. Cho biết tến giáo viến nào mà tham gia tầt cả các công việc của đế tài 006.

Q65. Cho biết giáo viến nào đã tham gia tầt cả các đế tài của chủ đế Ứng dụng công nghệ.

Q66. Cho biết tến giáo viến nào đã tham gia tầt cả các đế tài của do Trần Trà Hương làm chủ fnhiệm.

Q67. Cho biết tến đế tài nào mà được tầt cả các giáo viến của khoa CNTT tham gia.

Q68.7Cho biết tến giáo viến nào mà tham gia tầt cả các công việc của đế tài Nghiến cứu tế bào gôc.

Q69. Tìm tến các giáo viến được phần công làm tầt cả các đế tài có kinh phí trến 100 triệu?

Q70. Cho biết tến đế tài nào mà được tầt cả các giáo viến của khoa Sinh Học tham gia.

Q71. Cho biết mã sô, họ tến, ngày sinh của giáo viến tham gia tầt cả các công việc của đế tài “Ứng dụng hóa học xanh”.

Q72. Cho biết mã sô, họ tến, tến bộ môn và tến người quản lý chuyến môn của giáo viến tham gia tầt cả các đế tài thuộc chủ đế “Nghiến cứu phát triển”.

Q73. Cho biết họ tến, ngày sinh, tến khoa, tến trưởng khoa của giáo viến tham gia tầt cả các đế tài có giáo viến “Nguyến Hoài An” tham gia.

Q74. Cho biết họ tến giáo viến khoa “Công nghệ thông tin” tham gia tầt cả các công việc của đế tài
có trưởng bộ môn của bộ môn đông nhầt khoa “Công nghệ thông tin” làm chủ nhiệm.

**4.6 VIÊT CÁC CẦU TRUY VẦN NẦNG CAO** 

**@ TUẦN 7**

Q75. Cho biết họ tến giáo viến và tến bộ môn họ làm trưởng bộ môn nếu có

Q76. Cho danh sách tến bộ môn và họ tến trưởng bộ môn đó nếu có

Q77. Cho danh sách tến giáo viến và các đế tài giáo viến đó chủ nhiệm nếu có

Q78. Xuầt ra thông tin của giáo viến (MAGV, HOTEN) vàương của giáo viến. Mức lương

được xếp theo quy tăc: Lương của giáo viến < $1800 : “THẤP” ; Từ $1800 đến $2200: TRUNG BÌNH; Lương > $2200: “CAO”	

Q79. Xuầt ra thông tin giáo viến (MAGV, HOTEN) và xếp hạng dựa vào mức lương. Nếu giáo viến có lương cao nhầt thì hạng là 1.

Q80. Xuầt ra thông tin thu nhập của giáo viến. Thu nhập của giáo viến được tính băng LƯƠNG + PHỤ CẤP. Nếu giáo viến là trưởng bộ môn thì PHỤ CẤP là 300, và giáo viến là trưởng khoa thì PHỤ CẤP là 600.

Q81. Xuầt ra năm mà giáo viến dự kiến sẽ nghĩ hưu với quy định: Tuổi nghỉ hưu của Nam là 60, của Nữ là 55.


Q82. Cho biết danh sách tầt cả giáo viến (magv, hoten) và họ tến giáo viến là quản lý chuyến ôn của họ.

. Cho biếtdanh sáchtầt cả bộ môn (mabm, tenbm), tến trưởng bộ môn cùng sô lượng giáo viến của môi bộ môn.

Q84. Cho biết danh sách tầt cả các giáo viến nam và thông tin các công việc mà họ đã tham gia.

Q85. Cho biết danh sách tầt cả các giáo viến và thông tin các công việc thuộc đế tài 001 mà họ tham gia.

Q86. Cho biết thông tin các trưởng bộ môn (magv, hoten) sẽ vế hưu vào năm 2014. Biết răng độ tuổi vế hưu của giáo viến nam là 60 còn giáo viến nữ là 55.

Q87. Cho biết thông tin các trưởng khoa (magv) và năm họ sẽ vế hưu.

Q88. Tạo bảng DANHSACHTHIDUA (magv, sodtdat, danhhieu) gôm thông tin mã giáo viến, sô đế tài họ tham gia đạt kết quả và danh hiệu thi đua:

a.

![](img/Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.002.png)Insert dữ liệu cho bảng này (để trông cột danh hiệu)

b.

Sodtdat = 0 thì danh hiệu “chưa hoàn thành nhiệm vụ”

1 <= Sodtdat <= 2 thì danh hiệu “hoàn thành nhiệm vụ”

3 <= Sodtdat <= 5 thì danh hiệu “tiến tiến”

Sodtdat >= 6 thì danh hiệu “lao động xuầt săc”

![](Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.003.png)![](Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.004.png)Dựa vào cột sldtdat (sô lượng đế tài tham gia có kết quả là “đạt”) để’ cập nhật dữ liệu cho cột danh hiệu theo quy định:

ii.

iii.

iv.

![](Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.005.png)![](Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.006.png)![](Aspose.Words.8e56d8a0-ad55-42e1-9a8a-48edd2505b71.007.png)i.

Q89. Cho biết magv, họ tến và mức lương các giáo viến nữ của khoa “Công nghệ thông tin”, mức lương trung bình, mức lương lớn nhầt và nhỏ nhầt của các giáo viến này.

Q90. Cho biết makhoa, tenkhoa, sô lượng gv từng khoa, sô lượng gv trung bình, lớn nhầt và nhỏ nhầt của các khoa này.

Q91. Cho biết danh sách các tến chủ đế, kinh phí cho chủ đế (là kinh phí cầp cho các đế tài thuộc chủ đế), tổng kinh phí, kinh phí lớn nhầt và nhỏ nhầt cho các chủ đế.

Q92. Cho biết madt, tendt, kinh phí đế tài, mức kinh phí tổng và trung bình của các đế tài này theo từng giáo viến chủ nhiệm.

Q93. Cho biết madt, tendt, kinh phí đế tài, mức kinh phí tổng và trung bình của các đế tài này theo ù ộ đế tài.

Q94. Tổng ô lượng các đế tài theo (cầp độ, chủ đế), theo (cầp độ), theo (chủ đế).

Q95. Tổng hợp mức lương tổng của các giáo viến theo (bộ môn, phái), theo (bộ môn).

Tổng hợp sô lượng các giáo viến của khoa CNTT theo (bộ môn, lương), theo (bộ môn), theo (lương).

**4.7 VIÊT CÁC STORE PROCEDURE @ TUẦN 8**

P1. Xuầt ra toàn bộ danh sách giáo viến.

P2. Tính sô lượng đế tài mà một giáo viếnđang thực hiện.

P3. In thông tin chi tiết của một giáo viến(sử dụng lệnh print): Thông tin cá nhần, Sô lượng đế tài tham gia, Sô lượng thần nhần của giáo viến đó.

P4. Kiểm tra xem một giáo viến có tôn tại hay không (dựa vào HOTEN, NGSINH, DIACHI).

P5. Kiểm tra quy định của một giáo viến: Chỉ được thực hiện các đế tài mà bộ môn của giáo viến đó làm chủ nhiệm.

P6. Thực hiện thếm một phần công cho giáo viến thực hiện một công việc của đế tài:

o Kiểm tra thông tin đầu vào hợp lệ: giáo viến phải tôn tại, công việc phải tôn tại, thời gian tham gia phải >0

o Giáo viến chỉ tham gia đế tài cùng bộ môn với giáo viến làm chủ nhiệm đế tài đó.

P7. Thực hiện xoá một giáo viến theo mã. Nếu giáo viến có thông tin liến quan (Có thần nhần, có làm đế tài, ...) thì báo lôi.	*s*

P8. In ra danh sách giáo viến của một phòng ban nào đó cùng với sô lượng đế tài mà giáo viến tham gia, sô thần nhần, sô giáo viến mà giáo viến đó quản lý nếu có, ...

P9. Kiểm tra quy định của 2 giáo viến a, b: Nếu a là trưởng bộ môn của b thì lương của a phải cao hơn lương của b. (a, b: mã giáo viến)

P10. Khi thếm một giáo viến cần kiểm tra các quy định: Không trùng tến, tuổi > 18, lương > 0

P11. Mã giáo viến được phát sinh tự động theo quy tăc: Nếu đã có giáo viến 001, 002, 003 thì MAGV của giáo viến mới sẽ là 004. Nếu đã có giáo viến 001, 002, 005 thì MAGV của giáo viến mới là 003.

**4.8 VIÊT CÁC TRIGGER** 

**@ TUẦN 9**

*Lưu ý:* Môi RBTV có thể cần phải cài đặt trigger trến nhiếu bảng cho các thao tác khác nhau.

T1. Tến đế tài phải duy nhầt

T2. Trưởng bộ môn phải sinh sau trước 1975

T3. Một bộ môn có tôi thiểu 1 giáo viến nữ

T4. Một giáo viến phải có ít nhầt 1 sô điện thoại

T5. Một giáo viến có tôi đa 3 sô điện thoại

T6. Một bộ môn phải có tôi thiểu 4 giáo viến

T7. Trưởng bộ môn phải là người lớn tuổi nhầt trong bộ môn.
